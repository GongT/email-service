import {createSendApi, EmailSendResponse} from "./send-api";
import {ExpressHandler} from "../library/express-handler";
import {resolve} from "url";

const callback = resolve(JsonEnv.accounts.baseDomain, '/login/forgot-callback');
const inputCode = resolve(JsonEnv.accounts.baseDomain, '/login/forgot-callback');

export function createForgotPassword<T>(handler: ExpressHandler<T, EmailSendResponse>, argument: T) {
	createSendApi<T>(handler, argument, {
		subject: '[Microduino] user password reset',
		html: `<p>Hello, microduino user:</p>
<p>You have asked to reset your password.</p>
<p>Click this button to continue: <a href="${callback}?code={{code}}">${callback}?code={{code}}</a>.</p>
<p>if not work, please navigate to ${inputCode} in your browser, and paste this code: <br/>
	<input type="text" readonly value="{{code}}" /></p>
<p>If you did not want to reset password, you can simply ignore this email.</p>
`
	});
}
